# 同級任務權重分級系統設計

## 🎯 設計目標

解決「同級任務如何排序」的問題,透過**符號大小視覺化**讓使用者一眼看出哪個任務更重要。

---

## 📊 權重等級定義

### 四個權重等級

| 權重等級 | 英文代碼 | 說明 | 視覺特徵 |
|---------|---------|------|---------|
| 極高權重 | CRITICAL | 緊急且重要,影響全局 | 符號最大 |
| 高權重 | HIGH | 重要但不緊急,或緊急但影響範圍中等 | 符號較大 |
| 中權重 | MEDIUM | 一般重要性,常規任務 | 符號中等 |
| 低權重 | LOW | 不緊急不重要,可延後處理 | 符號較小 |

---

## 🎨 符號大小映射表

### 1級|營收 任務

| 權重 | 符號大小 | 使用場景範例 |
|------|---------|-------------|
| CRITICAL | 56px | 今日到期的大客戶簽約(金額 > 100萬) |
| HIGH | 48px | 本週內的重要客戶拜訪 |
| MEDIUM | 40px | 一般客戶需求訪談 |
| LOW | 32px | 銷售資料整理 |

### 2級|流量 任務

| 權重 | 符號大小 | 使用場景範例 |
|------|---------|-------------|
| CRITICAL | 48px | 今日必須發布的重要行銷活動 |
| HIGH | 40px | 本週內的 SEO 優化專案 |
| MEDIUM | 32px | 社群內容發布 |
| LOW | 28px | 數據分析報告 |

### 3級|行政 任務

| 權重 | 符號大小 | 使用場景範例 |
|------|---------|-------------|
| CRITICAL | 40px | 今日必須完成的法律文件簽署 |
| HIGH | 32px | 本週內的團隊週報審核 |
| MEDIUM | 28px | 會議室預訂 |
| LOW | 24px | 文件歸檔 |

### 4級|日常 任務

| 權重 | 符號大小 | 使用場景範例 |
|------|---------|-------------|
| CRITICAL | 32px | 緊急設備維修 |
| HIGH | 28px | 定期系統維護 |
| MEDIUM | 24px | 辦公室清潔 |
| LOW | 20px | 雜項整理 |

---

## 🧮 權重自動計算邏輯

### 計算公式

```
權重分數 = 截止日期緊急度(40%) + 影響範圍(30%) + 預估工作量(20%) + 符號權重(10%)
```

### 1. 截止日期緊急度 (40%)

| 截止時間 | 分數 | 權重貢獻 |
|---------|------|---------|
| 今日內到期 | 100 | 40 |
| 明日到期 | 80 | 32 |
| 2-3 天內 | 60 | 24 |
| 4-7 天內 | 40 | 16 |
| 超過 1 週 | 20 | 8 |

### 2. 影響範圍 (30%)

| 影響範圍 | 分數 | 權重貢獻 | 判斷依據 |
|---------|------|---------|---------|
| 公司整體 | 100 | 30 | 影響公司營收/品牌/戰略 |
| 跨部門 | 80 | 24 | 需要多個部門協作 |
| 部門內 | 60 | 18 | 影響部門績效 |
| 團隊內 | 40 | 12 | 影響團隊進度 |
| 個人 | 20 | 6 | 僅影響個人工作 |

### 3. 預估工作量 (20%)

| 工作量 | 分數 | 權重貢獻 | 時間範圍 |
|-------|------|---------|---------|
| 超大型 | 100 | 20 | > 8 小時 |
| 大型 | 80 | 16 | 4-8 小時 |
| 中型 | 60 | 12 | 2-4 小時 |
| 小型 | 40 | 8 | 1-2 小時 |
| 微型 | 20 | 4 | < 1 小時 |

### 4. 符號權重 (10%)

每個符號有固定的基礎權重,例如:
- 「簽約成交」符號 → 100 分 (權重貢獻 10)
- 「客戶拜訪」符號 → 90 分 (權重貢獻 9)
- 「產品銷售」符號 → 85 分 (權重貢獻 8.5)

### 權重等級判定

根據總分判定權重等級:

| 總分範圍 | 權重等級 |
|---------|---------|
| 80-100 | CRITICAL |
| 60-79 | HIGH |
| 40-59 | MEDIUM |
| 0-39 | LOW |

---

## 💡 實際範例

### 範例 1: 大客戶簽約任務

**任務資訊**:
- 截止日期:今日 18:00
- 影響範圍:公司整體(預計簽約金額 150 萬)
- 預估工作量:6 小時
- 符號:簽約成交

**權重計算**:
- 截止日期緊急度:100 × 0.4 = 40
- 影響範圍:100 × 0.3 = 30
- 預估工作量:80 × 0.2 = 16
- 符號權重:100 × 0.1 = 10
- **總分:96 → CRITICAL (符號 56px)**

### 範例 2: 一般客戶訪談

**任務資訊**:
- 截止日期:5 天後
- 影響範圍:部門內
- 預估工作量:2 小時
- 符號:客戶拜訪

**權重計算**:
- 截止日期緊急度:40 × 0.4 = 16
- 影響範圍:60 × 0.3 = 18
- 預估工作量:60 × 0.2 = 12
- 符號權重:90 × 0.1 = 9
- **總分:55 → MEDIUM (符號 40px)**

### 範例 3: 銷售資料整理

**任務資訊**:
- 截止日期:10 天後
- 影響範圍:個人
- 預估工作量:1 小時
- 符號:產品銷售

**權重計算**:
- 截止日期緊急度:20 × 0.4 = 8
- 影響範圍:20 × 0.3 = 6
- 預估工作量:40 × 0.2 = 8
- 符號權重:85 × 0.1 = 8.5
- **總分:30.5 → LOW (符號 32px)**

---

## 🎯 視覺化效果

### 同級任務排列範例

```
┌─────────────────────────────────┐
│  [超大符號 56px] 大客戶簽約      │  ← CRITICAL
│  今日 18:00 到期                 │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│  [大符號 48px] 產品銷售簡報      │  ← HIGH
│  明日 14:00 到期                 │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│  [中符號 40px] 客戶需求訪談      │  ← MEDIUM
│  5 天後到期                      │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│  [小符號 32px] 銷售資料整理      │  ← LOW
│  10 天後到期                     │
└─────────────────────────────────┘
```

使用者一眼就能看出:
- **符號越大 = 越重要**
- 同樣是「1級|營收」,但權重有明顯差異
- 無需閱讀文字,視覺即可判斷優先順序

---

## 🔧 技術實作

### 1. 類型定義

```typescript
export type TaskWeight = "CRITICAL" | "HIGH" | "MEDIUM" | "LOW";

export interface Task {
  // ... 現有欄位
  weight: TaskWeight;
  weightScore?: number; // 權重分數(0-100),用於排序
}
```

### 2. 權重計算函數

```typescript
export function calculateTaskWeight(task: Task): {
  weight: TaskWeight;
  score: number;
} {
  // 1. 計算截止日期緊急度
  const urgencyScore = calculateUrgencyScore(task.deadline);
  
  // 2. 計算影響範圍
  const impactScore = calculateImpactScore(task);
  
  // 3. 計算預估工作量
  const workloadScore = calculateWorkloadScore(task.estimatedMinutes);
  
  // 4. 計算符號權重
  const symbolScore = getSymbolWeight(task.symbolId);
  
  // 5. 加權計算總分
  const totalScore = 
    urgencyScore * 0.4 +
    impactScore * 0.3 +
    workloadScore * 0.2 +
    symbolScore * 0.1;
  
  // 6. 判定權重等級
  let weight: TaskWeight;
  if (totalScore >= 80) weight = "CRITICAL";
  else if (totalScore >= 60) weight = "HIGH";
  else if (totalScore >= 40) weight = "MEDIUM";
  else weight = "LOW";
  
  return { weight, score: totalScore };
}
```

### 3. 符號大小映射

```typescript
const SYMBOL_SIZE_MAP: Record<TaskLevel, Record<TaskWeight, number>> = {
  LEVEL_1_REVENUE: { CRITICAL: 56, HIGH: 48, MEDIUM: 40, LOW: 32 },
  LEVEL_2_TRAFFIC: { CRITICAL: 48, HIGH: 40, MEDIUM: 32, LOW: 28 },
  LEVEL_3_ADMIN: { CRITICAL: 40, HIGH: 32, MEDIUM: 28, LOW: 24 },
  LEVEL_4_DAILY: { CRITICAL: 32, HIGH: 28, MEDIUM: 24, LOW: 20 },
};

export function getSymbolSize(level: TaskLevel, weight: TaskWeight): number {
  return SYMBOL_SIZE_MAP[level][weight];
}
```

---

## ✅ 驗收標準

1. **自動計算**: 新增任務時,系統自動計算權重
2. **視覺差異**: 同級任務符號大小差異明顯(至少 8px)
3. **排序正確**: 任務列表按權重排序(CRITICAL > HIGH > MEDIUM > LOW)
4. **動態更新**: 任務資訊變更時,權重自動重新計算
5. **使用者理解**: 無需說明,使用者即可理解符號大小代表重要性

---

## 🚀 後續優化方向

1. **手動調整權重**: 允許使用者手動微調權重(±10 分)
2. **權重歷史**: 記錄權重變化歷史,分析任務重要性趨勢
3. **智能推薦**: 根據權重自動推薦今日應優先處理的任務
4. **視覺增強**: 為 CRITICAL 任務新增紅色邊框或閃爍動畫
