# 同級任務優先級排序解決方案

建立日期: 2025-11-27

---

## 🎯 問題核心

**使用者提出的關鍵洞察**:
> 星星數量會因人而異產生主觀認知差異。有人覺得 1 顆星就很急迫,有人覺得要 100 顆星才算急迫。

**結論**: 需要一個**客觀、可量化、系統自動計算**的排序機制,而非依賴主觀判斷。

---

## ✅ 最終方案:客觀評分自動排序

### 核心概念

使用**多維度客觀指標**自動計算優先級分數,系統根據分數自動排序,無需人為主觀判斷。

---

### 評分維度

#### 1. 截止日期緊急度 (40%)
```
距離截止日期剩餘時間:
- 今日內到期    → 100 分
- 1-2 天內到期  → 80 分
- 3-5 天內到期  → 60 分
- 6-7 天內到期  → 40 分
- 超過 1 週     → 20 分
- 無截止日期    → 10 分
```

#### 2. 預估工作量 (20%)
```
預估所需時間:
- 超過 8 小時   → 100 分 (大型任務優先處理)
- 4-8 小時      → 80 分
- 2-4 小時      → 60 分
- 1-2 小時      → 40 分
- 少於 1 小時   → 20 分
```

#### 3. 任務建立時間 (20%)
```
任務建立至今的時間:
- 超過 7 天     → 100 分 (長期未處理的任務)
- 5-7 天        → 80 分
- 3-5 天        → 60 分
- 1-3 天        → 40 分
- 今日建立      → 20 分
```

#### 4. 符號權重 (20%)
```
每個符號有固定權重值:

一級|營收:
  - 客戶簽約      → 100 分
  - 產品銷售      → 95 分
  - 商務洽談      → 90 分
  - 營收分析      → 85 分
  - 定價策略      → 80 分

二級|流量:
  - SEO 優化      → 100 分
  - 社群經營      → 95 分
  - 內容行銷      → 90 分
  - 廣告投放      → 85 分
  - 數據分析      → 80 分

三級|行政:
  - 法規遵循      → 100 分
  - 團隊管理      → 95 分
  - 流程優化      → 90 分
  - 文件整理      → 85 分
  - 行政庶務      → 80 分
```

---

### 計算公式

```typescript
優先級分數 = 
  (截止日期緊急度分數 × 0.4) + 
  (預估工作量分數 × 0.2) + 
  (任務建立時間分數 × 0.2) + 
  (符號權重分數 × 0.2)
```

---

### 實際案例

#### 案例 1: 兩個「一級|營收」任務比較

**任務 A: 客戶簽約**
- 截止日期: 今日內 → 100 分 × 0.4 = 40
- 預估工作量: 2 小時 → 40 分 × 0.2 = 8
- 建立時間: 3 天前 → 60 分 × 0.2 = 12
- 符號權重: 客戶簽約 → 100 分 × 0.2 = 20
- **總分: 80 分**

**任務 B: 產品銷售**
- 截止日期: 3 天後 → 60 分 × 0.4 = 24
- 預估工作量: 6 小時 → 80 分 × 0.2 = 16
- 建立時間: 7 天前 → 100 分 × 0.2 = 20
- 符號權重: 產品銷售 → 95 分 × 0.2 = 19
- **總分: 79 分**

**結果**: 任務 A (80 分) 排在任務 B (79 分) 前面

---

### 視覺呈現方式

#### 選項 1: 優先級標籤 (推薦)
在任務卡片右上角顯示系統計算的優先級等級:

```
┌─────────────────────────────────┐
│ [符號] 客戶簽約        [P1 極高]│
│ 負責人: 李安安                  │
│ 截止: 今日 18:00                │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ [符號] 產品銷售        [P2 高]  │
│ 負責人: 王小明                  │
│ 截止: 3 天後                    │
└─────────────────────────────────┘
```

**優先級等級定義**:
- P1 極高: 80-100 分 (紅色標籤)
- P2 高:   60-79 分  (橙色標籤)
- P3 中:   40-59 分  (黃色標籤)
- P4 低:   20-39 分  (綠色標籤)
- P5 極低: 0-19 分   (灰色標籤)

---

#### 選項 2: 顏色指示條
在任務卡片左側加入顏色指示條:

```
┃ [符號] 客戶簽約        (紅色粗條 = P1)
│ 負責人: 李安安
│ 截止: 今日 18:00

│ [符號] 產品銷售        (橙色中條 = P2)
│ 負責人: 王小明
│ 截止: 3 天後
```

---

#### 選項 3: 分數顯示 (最透明)
直接顯示系統計算的分數:

```
┌─────────────────────────────────┐
│ [符號] 客戶簽約        [80 分]  │
│ 負責人: 李安安                  │
│ 截止: 今日 18:00                │
└─────────────────────────────────┘
```

---

## 🎨 我的建議

### 推薦方案:優先級標籤 (選項 1)

**理由**:
1. **客觀量化**: 系統自動計算,無主觀認知差異
2. **清楚分級**: P1-P5 等級明確,易於理解
3. **視覺層次**: 顏色標籤提供直觀的視覺提示
4. **可追溯**: 使用者可點擊查看分數計算細節

**實作細節**:
```typescript
// 計算優先級分數
function calculatePriorityScore(task: Task): number {
  const deadlineScore = calculateDeadlineScore(task.deadline);
  const workloadScore = calculateWorkloadScore(task.estimatedTime);
  const ageScore = calculateAgeScore(task.createdAt);
  const symbolScore = getSymbolWeight(task.symbolId);
  
  return (
    deadlineScore * 0.4 +
    workloadScore * 0.2 +
    ageScore * 0.2 +
    symbolScore * 0.2
  );
}

// 轉換為優先級等級
function getPriorityLevel(score: number): {
  level: string;
  label: string;
  color: string;
} {
  if (score >= 80) return { level: 'P1', label: '極高', color: 'red' };
  if (score >= 60) return { level: 'P2', label: '高', color: 'orange' };
  if (score >= 40) return { level: 'P3', label: '中', color: 'yellow' };
  if (score >= 20) return { level: 'P4', label: '低', color: 'green' };
  return { level: 'P5', label: '極低', color: 'gray' };
}
```

---

## 📊 排序邏輯

### 最終排序規則

```typescript
tasks.sort((a, b) => {
  // 1. 先按任務分級排序 (一級 > 二級 > 三級)
  if (a.priority !== b.priority) {
    return priorityOrder[a.priority] - priorityOrder[b.priority];
  }
  
  // 2. 同級任務按優先級分數排序
  const scoreA = calculatePriorityScore(a);
  const scoreB = calculatePriorityScore(b);
  return scoreB - scoreA; // 分數高的在前
});
```

---

## ✅ 優勢總結

1. **完全客觀**: 基於可量化的數據,無主觀認知差異
2. **自動計算**: 系統自動更新,無需人為干預
3. **透明可追溯**: 使用者可查看分數計算依據
4. **動態調整**: 隨著時間推移,分數自動更新(例如截止日期接近)
5. **符合業務邏輯**: 結合截止日期、工作量、任務年齡等實際因素

---

## 🔧 實作計畫

### Phase 1: 建立評分系統
- [ ] 定義符號權重表
- [ ] 實作評分計算函數
- [ ] 實作優先級等級轉換函數

### Phase 2: 更新任務資料結構
- [ ] 在 Task 類型新增 `deadline` 欄位
- [ ] 在 Task 類型新增 `createdAt` 欄位
- [ ] 在 Task 類型新增 `priorityScore` 計算屬性

### Phase 3: 更新 UI 顯示
- [ ] 在 TaskCard 右上角新增優先級標籤
- [ ] 實作顏色標籤樣式(紅/橙/黃/綠/灰)
- [ ] 新增優先級分數計算細節彈窗

### Phase 4: 更新排序邏輯
- [ ] 更新任務列表排序函數
- [ ] 測試排序結果

---

## 💡 未來擴展

### 可調整的權重
允許管理員調整各維度的權重比例:
```
截止日期緊急度: [====40%====] 
預估工作量:     [==20%==]
任務建立時間:   [==20%==]
符號權重:       [==20%==]
```

### 個人化調整
允許使用者微調個別任務的優先級:
```
系統計算: P2 (75 分)
手動調整: P1 (強制提升)
```

---

**結論**: 採用客觀評分自動排序機制,完全解決主觀認知差異問題!
