# AI å­¸ç¿’å‹ä»»å‹™ç®¡ç†ç³»çµ± - å¯¦ä½œæŒ‡å—

å»ºç«‹æ—¥æœŸ: 2025-11-27  
ç‰ˆæœ¬: v1.0

---

## ğŸ“‹ æ–‡ä»¶æ¦‚è¦½

æœ¬å¯¦ä½œæŒ‡å—æä¾›å®Œæ•´çš„æŠ€è¡“å¯¦ä½œç´°ç¯€,åŒ…æ‹¬:
1. æŠ€è¡“æ¶æ§‹é¸å‹
2. è³‡æ–™åº«é·ç§»è…³æœ¬
3. API è¨­è¨ˆè¦ç¯„
4. å‰ç«¯æ•´åˆæ–¹æ¡ˆ
5. AI æœå‹™æ•´åˆ
6. éƒ¨ç½²èˆ‡ç¶­é‹

---

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### ç³»çµ±æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯æ‡‰ç”¨å±¤                          â”‚
â”‚  React 19 + TypeScript + Tailwind CSS + shadcn/ui      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ REST API / GraphQL
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å¾Œç«¯æœå‹™å±¤                           â”‚
â”‚  Node.js + Express / Fastify + TypeScript               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”œâ”€ ä»»å‹™ç®¡ç†æœå‹™ (Task Service)                         â”‚
â”‚  â”œâ”€ æ¨¡æ¿æœå‹™ (Template Service)                         â”‚
â”‚  â”œâ”€ AI åˆ†ææœå‹™ (AI Analysis Service)                   â”‚
â”‚  â”œâ”€ äº‹ä»¶è¿½è¹¤æœå‹™ (Event Tracking Service)               â”‚
â”‚  â””â”€ é€šçŸ¥æœå‹™ (Notification Service)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è³‡æ–™å±¤                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PostgreSQL (ä¸»è³‡æ–™åº«)                                   â”‚
â”‚  â”œâ”€ tasks, task_events, task_issues                     â”‚
â”‚  â”œâ”€ task_templates, template_usage_logs                 â”‚
â”‚  â””â”€ company_culture_features, ai_learning_logs          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Redis (å¿«å– & ä½‡åˆ—)                                     â”‚
â”‚  â”œâ”€ ä»»å‹™å¿«å–                                             â”‚
â”‚  â”œâ”€ ä½¿ç”¨è€… Session                                       â”‚
â”‚  â””â”€ èƒŒæ™¯ä»»å‹™ä½‡åˆ—                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å¤–éƒ¨æœå‹™                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  OpenAI GPT-4 API (AI åˆ†æ)                             â”‚
â”‚  S3 / MinIO (æª”æ¡ˆå„²å­˜)                                   â”‚
â”‚  SendGrid / AWS SES (éƒµä»¶é€šçŸ¥)                          â”‚
â”‚  Slack API (å³æ™‚é€šçŸ¥)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€è¡“é¸å‹

| å±¤ç´š | æŠ€è¡“ | ç†ç”± |
|------|------|------|
| å‰ç«¯æ¡†æ¶ | React 19 | ç¾ä»£åŒ–ã€ç”Ÿæ…‹å®Œå–„ã€æ•ˆèƒ½å„ªç•° |
| å‰ç«¯èªè¨€ | TypeScript | å‹åˆ¥å®‰å…¨ã€é–‹ç™¼æ•ˆç‡é«˜ |
| UI æ¡†æ¶ | Tailwind CSS + shadcn/ui | å¿«é€Ÿé–‹ç™¼ã€ä¸€è‡´æ€§é«˜ |
| å¾Œç«¯æ¡†æ¶ | Node.js + Fastify | é«˜æ•ˆèƒ½ã€TypeScript å‹å¥½ |
| è³‡æ–™åº« | PostgreSQL 14+ | æˆç†Ÿç©©å®šã€æ”¯æ´ JSONBã€æ•ˆèƒ½å„ªç•° |
| å¿«å– | Redis 7+ | é«˜æ•ˆèƒ½ã€æ”¯æ´å¤šç¨®è³‡æ–™çµæ§‹ |
| AI æœå‹™ | OpenAI GPT-4 | å¼·å¤§çš„ NLP èƒ½åŠ›ã€API å‹å¥½ |
| æª”æ¡ˆå„²å­˜ | S3 / MinIO | å¯æ“´å±•ã€æˆæœ¬æ•ˆç›Šé«˜ |
| ä½‡åˆ— | BullMQ | å¯é ã€æ”¯æ´å„ªå…ˆç´šã€æ˜“æ–¼ç›£æ§ |

---

## ğŸ—„ï¸ è³‡æ–™åº«å¯¦ä½œ

### 1. è³‡æ–™åº«åˆå§‹åŒ–

```sql
-- å»ºç«‹è³‡æ–™åº«
CREATE DATABASE task_management_ai;

-- å•Ÿç”¨æ“´å……åŠŸèƒ½
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE EXTENSION IF NOT EXISTS "pg_trgm"; -- ç”¨æ–¼æ–‡å­—ç›¸ä¼¼åº¦æœå°‹
CREATE EXTENSION IF NOT EXISTS "btree_gin"; -- ç”¨æ–¼ JSONB ç´¢å¼•å„ªåŒ–
```

### 2. å»ºç«‹è³‡æ–™è¡¨

```sql
-- ä½¿ç”¨è€…è¡¨
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  name VARCHAR(100) NOT NULL,
  email VARCHAR(255) UNIQUE NOT NULL,
  avatar VARCHAR(500),
  department_id UUID REFERENCES departments(id),
  role VARCHAR(50),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- éƒ¨é–€è¡¨
CREATE TABLE departments (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  name VARCHAR(100) NOT NULL,
  description TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

-- ä»»å‹™è¡¨
CREATE TABLE tasks (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  title VARCHAR(200) NOT NULL,
  description TEXT,
  priority VARCHAR(20) NOT NULL CHECK (priority IN ('high', 'medium', 'low')),
  status VARCHAR(20) NOT NULL CHECK (status IN ('pending', 'in-progress', 'completed', 'cancelled')),
  
  -- åˆ†é¡
  category VARCHAR(50),
  symbol_id VARCHAR(50),
  
  -- äººå“¡
  assignee_id UUID REFERENCES users(id) NOT NULL,
  department_id UUID REFERENCES departments(id),
  
  -- æ™‚é–“
  estimated_minutes INTEGER,
  actual_minutes INTEGER,
  deadline TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  completed_at TIMESTAMP,
  
  -- å„ªå…ˆç´šè©•åˆ†
  priority_score INTEGER,
  
  -- AI åˆ†æ
  ai_analysis JSONB,
  
  -- æ¨¡æ¿
  template_id UUID REFERENCES task_templates(id),
  is_from_template BOOLEAN DEFAULT FALSE,
  
  -- å“è³ª
  quality VARCHAR(20) CHECK (quality IN ('excellent', 'good', 'acceptable', 'poor')),
  
  -- ç‰ˆæœ¬
  version INTEGER DEFAULT 1,
  parent_task_id UUID REFERENCES tasks(id)
);

-- ä»»å‹™äº‹ä»¶è¡¨
CREATE TABLE task_events (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  task_id UUID REFERENCES tasks(id) NOT NULL ON DELETE CASCADE,
  event_type VARCHAR(50) NOT NULL,
  timestamp TIMESTAMP DEFAULT NOW() NOT NULL,
  user_id UUID REFERENCES users(id),
  user_role VARCHAR(50),
  event_data JSONB NOT NULL,
  before_state JSONB,
  after_state JSONB,
  context JSONB
);

-- ä»»å‹™å•é¡Œè¡¨
CREATE TABLE task_issues (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  task_id UUID REFERENCES tasks(id) NOT NULL ON DELETE CASCADE,
  issue_type VARCHAR(50) NOT NULL,
  severity VARCHAR(20) NOT NULL CHECK (severity IN ('low', 'medium', 'high', 'critical')),
  title VARCHAR(200) NOT NULL,
  description TEXT NOT NULL,
  root_cause TEXT,
  category VARCHAR(50),
  impact_description TEXT,
  time_wasted_minutes INTEGER DEFAULT 0,
  solution TEXT,
  prevention_measures TEXT,
  status VARCHAR(20) DEFAULT 'open' CHECK (status IN ('open', 'in_progress', 'resolved', 'closed')),
  reported_by UUID REFERENCES users(id),
  resolved_by UUID REFERENCES users(id),
  reported_at TIMESTAMP DEFAULT NOW(),
  resolved_at TIMESTAMP,
  is_recurring BOOLEAN DEFAULT FALSE,
  similar_issues UUID[],
  ai_prevention_score FLOAT
);

-- ä»»å‹™æ¨¡æ¿è¡¨
CREATE TABLE task_templates (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  name VARCHAR(200) NOT NULL,
  description TEXT,
  category VARCHAR(50) NOT NULL,
  subcategory VARCHAR(50),
  template_data JSONB NOT NULL,
  generation_method VARCHAR(20) NOT NULL CHECK (generation_method IN ('manual', 'ai_generated', 'ai_learned')),
  source_task_ids UUID[],
  learning_iteration INTEGER DEFAULT 1,
  confidence_score FLOAT,
  usage_count INTEGER DEFAULT 0,
  success_rate FLOAT,
  avg_completion_time INTEGER,
  culture_fit_score FLOAT,
  culture_features JSONB,
  status VARCHAR(20) DEFAULT 'active' CHECK (status IN ('draft', 'active', 'archived')),
  is_public BOOLEAN DEFAULT FALSE,
  created_by UUID REFERENCES users(id),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  version INTEGER DEFAULT 1,
  parent_template_id UUID REFERENCES task_templates(id)
);

-- æ¨¡æ¿ä½¿ç”¨è¨˜éŒ„è¡¨
CREATE TABLE template_usage_logs (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  template_id UUID REFERENCES task_templates(id) NOT NULL,
  task_id UUID REFERENCES tasks(id) NOT NULL,
  user_id UUID REFERENCES users(id) NOT NULL,
  department_id UUID REFERENCES departments(id),
  used_at TIMESTAMP DEFAULT NOW(),
  modifications JSONB,
  modification_count INTEGER DEFAULT 0,
  task_completed BOOLEAN,
  completion_time_minutes INTEGER,
  actual_vs_estimated_ratio FLOAT,
  issues_encountered INTEGER DEFAULT 0,
  issue_ids UUID[],
  user_rating INTEGER CHECK (user_rating BETWEEN 1 AND 5),
  user_feedback TEXT,
  would_use_again BOOLEAN,
  is_successful BOOLEAN,
  learning_value_score FLOAT
);

-- å…¬å¸æ–‡åŒ–ç‰¹å¾µè¡¨
CREATE TABLE company_culture_features (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  feature_name VARCHAR(100) NOT NULL,
  feature_type VARCHAR(50) NOT NULL,
  description TEXT,
  examples TEXT[],
  feature_value JSONB NOT NULL,
  learned_from VARCHAR(50),
  confidence_score FLOAT,
  applicable_departments VARCHAR(50)[],
  applicable_task_types VARCHAR(50)[],
  status VARCHAR(20) DEFAULT 'active' CHECK (status IN ('draft', 'active', 'archived')),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- AI å­¸ç¿’è¨˜éŒ„è¡¨
CREATE TABLE ai_learning_logs (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  learning_type VARCHAR(50) NOT NULL,
  timestamp TIMESTAMP DEFAULT NOW(),
  input_data JSONB NOT NULL,
  output_data JSONB NOT NULL,
  model_version VARCHAR(50),
  algorithm VARCHAR(50),
  accuracy FLOAT,
  precision FLOAT,
  recall FLOAT,
  f1_score FLOAT,
  insights JSONB,
  recommendations JSONB,
  applied_to_template_ids UUID[],
  applied_to_feature_ids UUID[]
);

-- å”ä½œè€…é—œè¯è¡¨
CREATE TABLE task_collaborators (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  task_id UUID REFERENCES tasks(id) NOT NULL ON DELETE CASCADE,
  user_id UUID REFERENCES users(id) NOT NULL,
  role VARCHAR(50),
  added_at TIMESTAMP DEFAULT NOW(),
  added_by UUID REFERENCES users(id)
);

-- å­ä»»å‹™è¡¨
CREATE TABLE subtasks (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  task_id UUID REFERENCES tasks(id) NOT NULL ON DELETE CASCADE,
  title VARCHAR(200) NOT NULL,
  estimated_time INTEGER,
  actual_time INTEGER,
  status VARCHAR(20) DEFAULT 'pending' CHECK (status IN ('pending', 'in-progress', 'completed')),
  order_index INTEGER,
  start_time TIMESTAMP,
  end_time TIMESTAMP,
  action_logs JSONB
);
```

### 3. å»ºç«‹ç´¢å¼•

```sql
-- ä»»å‹™è¡¨ç´¢å¼•
CREATE INDEX idx_tasks_status ON tasks(status);
CREATE INDEX idx_tasks_assignee ON tasks(assignee_id);
CREATE INDEX idx_tasks_department ON tasks(department_id);
CREATE INDEX idx_tasks_created_at ON tasks(created_at);
CREATE INDEX idx_tasks_deadline ON tasks(deadline);
CREATE INDEX idx_tasks_category ON tasks(category);
CREATE INDEX idx_tasks_template ON tasks(template_id);
CREATE INDEX idx_tasks_priority_score ON tasks(priority_score DESC);

-- ä»»å‹™äº‹ä»¶è¡¨ç´¢å¼•
CREATE INDEX idx_task_events_task_id ON task_events(task_id);
CREATE INDEX idx_task_events_type ON task_events(event_type);
CREATE INDEX idx_task_events_timestamp ON task_events(timestamp DESC);
CREATE INDEX idx_task_events_user ON task_events(user_id);

-- ä»»å‹™å•é¡Œè¡¨ç´¢å¼•
CREATE INDEX idx_task_issues_task_id ON task_issues(task_id);
CREATE INDEX idx_task_issues_type ON task_issues(issue_type);
CREATE INDEX idx_task_issues_severity ON task_issues(severity);
CREATE INDEX idx_task_issues_status ON task_issues(status);
CREATE INDEX idx_task_issues_category ON task_issues(category);
CREATE INDEX idx_task_issues_recurring ON task_issues(is_recurring) WHERE is_recurring = true;

-- æ¨¡æ¿è¡¨ç´¢å¼•
CREATE INDEX idx_task_templates_category ON task_templates(category);
CREATE INDEX idx_task_templates_status ON task_templates(status);
CREATE INDEX idx_task_templates_confidence ON task_templates(confidence_score DESC);
CREATE INDEX idx_task_templates_usage ON task_templates(usage_count DESC);

-- æ¨¡æ¿ä½¿ç”¨è¨˜éŒ„ç´¢å¼•
CREATE INDEX idx_template_usage_template_id ON template_usage_logs(template_id);
CREATE INDEX idx_template_usage_task_id ON template_usage_logs(task_id);
CREATE INDEX idx_template_usage_user_id ON template_usage_logs(user_id);
CREATE INDEX idx_template_usage_used_at ON template_usage_logs(used_at DESC);

-- JSONB æ¬„ä½ç´¢å¼• (GIN)
CREATE INDEX idx_tasks_ai_analysis ON tasks USING GIN (ai_analysis);
CREATE INDEX idx_task_events_event_data ON task_events USING GIN (event_data);
CREATE INDEX idx_task_templates_template_data ON task_templates USING GIN (template_data);

-- å…¨æ–‡æœå°‹ç´¢å¼•
CREATE INDEX idx_tasks_title_trgm ON tasks USING GIN (title gin_trgm_ops);
CREATE INDEX idx_tasks_description_trgm ON tasks USING GIN (description gin_trgm_ops);
```

### 4. å»ºç«‹è§¸ç™¼å™¨

```sql
-- è‡ªå‹•æ›´æ–° updated_at
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_tasks_updated_at
  BEFORE UPDATE ON tasks
  FOR EACH ROW
  EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_task_templates_updated_at
  BEFORE UPDATE ON task_templates
  FOR EACH ROW
  EXECUTE FUNCTION update_updated_at_column();

-- è‡ªå‹•æ›´æ–°æ¨¡æ¿ä½¿ç”¨æ¬¡æ•¸
CREATE OR REPLACE FUNCTION increment_template_usage()
RETURNS TRIGGER AS $$
BEGIN
  UPDATE task_templates
  SET usage_count = usage_count + 1
  WHERE id = NEW.template_id;
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER increment_template_usage_trigger
  AFTER INSERT ON template_usage_logs
  FOR EACH ROW
  EXECUTE FUNCTION increment_template_usage();
```

---

## ğŸ”Œ API è¨­è¨ˆ

### RESTful API ç«¯é»

#### ä»»å‹™ç®¡ç† API

```typescript
// å»ºç«‹ä»»å‹™
POST /api/tasks
Request Body:
{
  "input": {
    "method": "text" | "file" | "audio",
    "content": string,
    "files"?: File[]
  },
  "assigneeId": string,
  "collaboratorIds": string[],
  "templateId"?: string
}
Response:
{
  "task": Task,
  "aiAnalysis": AIAnalysisResult,
  "suggestedTemplate"?: TemplateRecommendation[]
}

// å–å¾—ä»»å‹™åˆ—è¡¨
GET /api/tasks?status=pending&assignee=user-123&department=sales
Response:
{
  "tasks": Task[],
  "total": number,
  "page": number,
  "pageSize": number
}

// å–å¾—ä»»å‹™è©³æƒ…
GET /api/tasks/:taskId
Response:
{
  "task": Task,
  "events": TaskEvent[],
  "issues": TaskIssue[],
  "subtasks": Subtask[],
  "collaborators": User[]
}

// æ›´æ–°ä»»å‹™
PATCH /api/tasks/:taskId
Request Body:
{
  "title"?: string,
  "description"?: string,
  "status"?: TaskStatus,
  "priority"?: TaskPriority,
  // ... å…¶ä»–æ¬„ä½
}

// é–‹å§‹ä»»å‹™
POST /api/tasks/:taskId/start
Response:
{
  "task": Task,
  "event": TaskEvent
}

// å®Œæˆä»»å‹™
POST /api/tasks/:taskId/complete
Request Body:
{
  "quality": "excellent" | "good" | "acceptable" | "poor",
  "deliverables": Deliverable[],
  "notes"?: string
}

// å›å ±å•é¡Œ
POST /api/tasks/:taskId/issues
Request Body:
{
  "issueType": string,
  "severity": "low" | "medium" | "high" | "critical",
  "title": string,
  "description": string,
  "timeWasted": number
}
```

#### æ¨¡æ¿ç®¡ç† API

```typescript
// æœå°‹æ¨¡æ¿
GET /api/templates?category=financial_report&status=active
Response:
{
  "templates": TaskTemplate[],
  "total": number
}

// å–å¾—æ¨¡æ¿è©³æƒ…
GET /api/templates/:templateId
Response:
{
  "template": TaskTemplate,
  "usageStats": TemplateUsageStats,
  "analytics": TemplateAnalytics
}

// å»ºç«‹æ¨¡æ¿
POST /api/templates
Request Body:
{
  "name": string,
  "category": string,
  "templateData": TemplateData,
  "generationMethod": "manual" | "ai_generated"
}

// å¾ä»»å‹™ç”Ÿæˆæ¨¡æ¿
POST /api/templates/generate-from-task
Request Body:
{
  "taskId": string,
  "name": string,
  "description": string
}

// æ¨è–¦æ¨¡æ¿
POST /api/templates/recommend
Request Body:
{
  "taskInput": {
    "description": string,
    "category"?: string
  },
  "userId": string
}
Response:
{
  "recommendations": TemplateRecommendation[]
}

// æ¨¡æ¿å›é¥‹
POST /api/templates/:templateId/feedback
Request Body:
{
  "taskId": string,
  "rating": number,
  "feedback": string,
  "wouldUseAgain": boolean
}
```

#### AI åˆ†æ API

```typescript
// åˆ†æä»»å‹™è¼¸å…¥
POST /api/ai/analyze-task
Request Body:
{
  "input": string,
  "context"?: {
    "department": string,
    "userId": string
  }
}
Response:
{
  "analysis": AIAnalysisResult,
  "confidence": number
}

// é æ¸¬æ½›åœ¨å•é¡Œ
POST /api/ai/predict-issues
Request Body:
{
  "taskId": string
}
Response:
{
  "warnings": Warning[],
  "recommendations": string[]
}

// å­¸ç¿’å…¬å¸æ–‡åŒ–
POST /api/ai/learn-culture
Response:
{
  "cultureProfile": CompanyCultureProfile,
  "learningStats": LearningStats
}

// å„ªåŒ–æ¨¡æ¿
POST /api/ai/optimize-template
Request Body:
{
  "templateId": string
}
Response:
{
  "optimizationResult": TemplateOptimization,
  "newTemplateId"?: string
}
```

---

## ğŸ’» å‰ç«¯æ•´åˆ

### 1. API å®¢æˆ¶ç«¯è¨­å®š

```typescript
// src/lib/api-client.ts
import axios from 'axios';

const apiClient = axios.create({
  baseURL: import.meta.env.VITE_API_URL || 'http://localhost:3001/api',
  timeout: 30000,
  headers: {
    'Content-Type': 'application/json',
  },
});

// è«‹æ±‚æ””æˆªå™¨
apiClient.interceptors.request.use(
  (config) => {
    const token = localStorage.getItem('auth_token');
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => Promise.reject(error)
);

// å›æ‡‰æ””æˆªå™¨
apiClient.interceptors.response.use(
  (response) => response.data,
  (error) => {
    if (error.response?.status === 401) {
      // è™•ç†æœªæˆæ¬Š
      window.location.href = '/login';
    }
    return Promise.reject(error);
  }
);

export default apiClient;
```

### 2. ä»»å‹™æœå‹™

```typescript
// src/services/taskService.ts
import apiClient from '@/lib/api-client';
import type { Task, CreateTaskInput, TaskEvent } from '@/types/task';

export const taskService = {
  // å»ºç«‹ä»»å‹™
  async createTask(input: CreateTaskInput): Promise<{
    task: Task;
    aiAnalysis: any;
    suggestedTemplates?: any[];
  }> {
    return await apiClient.post('/tasks', input);
  },

  // å–å¾—ä»»å‹™åˆ—è¡¨
  async getTasks(params?: {
    status?: string;
    assignee?: string;
    department?: string;
    page?: number;
    pageSize?: number;
  }): Promise<{
    tasks: Task[];
    total: number;
  }> {
    return await apiClient.get('/tasks', { params });
  },

  // å–å¾—ä»»å‹™è©³æƒ…
  async getTask(taskId: string): Promise<{
    task: Task;
    events: TaskEvent[];
    issues: any[];
    subtasks: any[];
  }> {
    return await apiClient.get(`/tasks/${taskId}`);
  },

  // æ›´æ–°ä»»å‹™
  async updateTask(taskId: string, updates: Partial<Task>): Promise<Task> {
    return await apiClient.patch(`/tasks/${taskId}`, updates);
  },

  // é–‹å§‹ä»»å‹™
  async startTask(taskId: string): Promise<Task> {
    return await apiClient.post(`/tasks/${taskId}/start`);
  },

  // å®Œæˆä»»å‹™
  async completeTask(taskId: string, data: {
    quality: string;
    deliverables: any[];
    notes?: string;
  }): Promise<Task> {
    return await apiClient.post(`/tasks/${taskId}/complete`, data);
  },

  // å›å ±å•é¡Œ
  async reportIssue(taskId: string, issue: {
    issueType: string;
    severity: string;
    title: string;
    description: string;
    timeWasted: number;
  }): Promise<any> {
    return await apiClient.post(`/tasks/${taskId}/issues`, issue);
  },
};
```

### 3. æ¨¡æ¿æœå‹™

```typescript
// src/services/templateService.ts
import apiClient from '@/lib/api-client';
import type { TaskTemplate } from '@/types/template';

export const templateService = {
  // æœå°‹æ¨¡æ¿
  async searchTemplates(params?: {
    category?: string;
    status?: string;
  }): Promise<{
    templates: TaskTemplate[];
    total: number;
  }> {
    return await apiClient.get('/templates', { params });
  },

  // å–å¾—æ¨¡æ¿è©³æƒ…
  async getTemplate(templateId: string): Promise<{
    template: TaskTemplate;
    usageStats: any;
    analytics: any;
  }> {
    return await apiClient.get(`/templates/${templateId}`);
  },

  // æ¨è–¦æ¨¡æ¿
  async recommendTemplates(input: {
    taskInput: {
      description: string;
      category?: string;
    };
    userId: string;
  }): Promise<{
    recommendations: any[];
  }> {
    return await apiClient.post('/templates/recommend', input);
  },

  // æäº¤å›é¥‹
  async submitFeedback(templateId: string, feedback: {
    taskId: string;
    rating: number;
    feedback: string;
    wouldUseAgain: boolean;
  }): Promise<void> {
    return await apiClient.post(`/templates/${templateId}/feedback`, feedback);
  },
};
```

### 4. React Hooks

```typescript
// src/hooks/useTasks.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { taskService } from '@/services/taskService';
import type { Task, CreateTaskInput } from '@/types/task';

export function useTasks(params?: any) {
  return useQuery({
    queryKey: ['tasks', params],
    queryFn: () => taskService.getTasks(params),
  });
}

export function useTask(taskId: string) {
  return useQuery({
    queryKey: ['task', taskId],
    queryFn: () => taskService.getTask(taskId),
    enabled: !!taskId,
  });
}

export function useCreateTask() {
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: (input: CreateTaskInput) => taskService.createTask(input),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['tasks'] });
    },
  });
}

export function useUpdateTask() {
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: ({ taskId, updates }: { taskId: string; updates: Partial<Task> }) =>
      taskService.updateTask(taskId, updates),
    onSuccess: (_, variables) => {
      queryClient.invalidateQueries({ queryKey: ['task', variables.taskId] });
      queryClient.invalidateQueries({ queryKey: ['tasks'] });
    },
  });
}

export function useStartTask() {
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: (taskId: string) => taskService.startTask(taskId),
    onSuccess: (_, taskId) => {
      queryClient.invalidateQueries({ queryKey: ['task', taskId] });
      queryClient.invalidateQueries({ queryKey: ['tasks'] });
    },
  });
}
```

---

## ğŸ¤– AI æœå‹™æ•´åˆ

### OpenAI GPT-4 æ•´åˆ

```typescript
// server/services/aiService.ts
import OpenAI from 'openai';

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY,
});

export class AIService {
  // åˆ†æä»»å‹™è¼¸å…¥
  async analyzeTaskInput(input: string, context?: any): Promise<AIAnalysisResult> {
    const prompt = `
ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„ä»»å‹™ç®¡ç†åŠ©æ‰‹ã€‚è«‹åˆ†æä»¥ä¸‹ä»»å‹™æè¿°,ä¸¦æä¾›çµæ§‹åŒ–çš„åˆ†æçµæœã€‚

ä»»å‹™æè¿°: ${input}

${context ? `ä¸Šä¸‹æ–‡è³‡è¨Š:\n- éƒ¨é–€: ${context.department}\n- ä½¿ç”¨è€…: ${context.userName}` : ''}

è«‹ä»¥ JSON æ ¼å¼è¿”å›ä»¥ä¸‹è³‡è¨Š:
{
  "taskType": {
    "category": "ä»»å‹™é¡å‹(ä¾‹å¦‚:è²¡å‹™å ±å‘Š/å®¢æˆ¶æœƒè­°/ç”¢å“é–‹ç™¼)",
    "subcategory": "å­é¡å‹",
    "confidence": 0.0-1.0
  },
  "extractedInfo": {
    "title": "ç°¡çŸ­ç›´è¦ºçš„ä»»å‹™æ¨™é¡Œ",
    "description": "è©³ç´°æè¿°",
    "priority": "high/medium/low",
    "estimatedMinutes": é ä¼°æ™‚é–“(åˆ†é˜),
    "deadline": "æˆªæ­¢æ—¥æœŸ(ISO 8601æ ¼å¼,å¦‚æœæœ‰æåˆ°)",
    "suggestedSubtasks": [
      {
        "title": "å­ä»»å‹™æ¨™é¡Œ",
        "estimatedTime": é ä¼°æ™‚é–“(åˆ†é˜),
        "order": é †åº
      }
    ]
  },
  "reasoning": "åˆ†ææ¨ç†éç¨‹"
}
`;

    const response = await openai.chat.completions.create({
      model: 'gpt-4',
      messages: [
        {
          role: 'system',
          content: 'ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„ä»»å‹™ç®¡ç† AI åŠ©æ‰‹,æ“…é•·åˆ†æä»»å‹™éœ€æ±‚ä¸¦æä¾›çµæ§‹åŒ–å»ºè­°ã€‚',
        },
        {
          role: 'user',
          content: prompt,
        },
      ],
      temperature: 0.3,
      response_format: { type: 'json_object' },
    });

    const result = JSON.parse(response.choices[0].message.content!);
    return result;
  }

  // é æ¸¬æ½›åœ¨å•é¡Œ
  async predictIssues(task: Task, historicalIssues: TaskIssue[]): Promise<Warning[]> {
    const prompt = `
åˆ†æä»¥ä¸‹ä»»å‹™,æ ¹æ“šæ­·å²å•é¡Œé æ¸¬å¯èƒ½é‡åˆ°çš„å•é¡Œã€‚

ç•¶å‰ä»»å‹™:
- æ¨™é¡Œ: ${task.title}
- é¡å‹: ${task.category}
- é ä¼°æ™‚é–“: ${task.estimatedMinutes} åˆ†é˜
- æˆªæ­¢æ—¥æœŸ: ${task.deadline}

æ­·å²ç›¸ä¼¼ä»»å‹™å¸¸è¦‹å•é¡Œ:
${historicalIssues.map(issue => `- ${issue.title} (ç™¼ç”Ÿç‡: ${issue.frequency})`).join('\n')}

è«‹ä»¥ JSON æ ¼å¼è¿”å›é æ¸¬çš„å•é¡Œå’Œå»ºè­°:
{
  "warnings": [
    {
      "type": "å•é¡Œé¡å‹",
      "severity": "low/medium/high/critical",
      "message": "è­¦å‘Šè¨Šæ¯",
      "probability": 0.0-1.0,
      "preventionMeasures": ["é é˜²æªæ–½1", "é é˜²æªæ–½2"]
    }
  ]
}
`;

    const response = await openai.chat.completions.create({
      model: 'gpt-4',
      messages: [
        {
          role: 'system',
          content: 'ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„é¢¨éšªåˆ†æå¸«,æ“…é•·é æ¸¬ä»»å‹™åŸ·è¡Œä¸­å¯èƒ½é‡åˆ°çš„å•é¡Œã€‚',
        },
        {
          role: 'user',
          content: prompt,
        },
      ],
      temperature: 0.5,
      response_format: { type: 'json_object' },
    });

    const result = JSON.parse(response.choices[0].message.content!);
    return result.warnings;
  }

  // ç”Ÿæˆæ¨¡æ¿æè¿°
  async generateTemplateDescription(
    category: string,
    patterns: TaskStructurePattern
  ): Promise<string> {
    const prompt = `
æ ¹æ“šä»¥ä¸‹ä»»å‹™æ¨¡å¼,ç”Ÿæˆä¸€å€‹å°ˆæ¥­çš„æ¨¡æ¿æè¿°ã€‚

ä»»å‹™é¡å‹: ${category}

æ¨¡å¼åˆ†æ:
- å¹³å‡å®Œæˆæ™‚é–“: ${patterns.timePattern.avgTotalTime} åˆ†é˜
- å¸¸è¦‹å­ä»»å‹™: ${patterns.commonSubtasks.map(st => st.title).join(', ')}
- å…¸å‹åœ˜éšŠè¦æ¨¡: ${patterns.collaborationPattern.avgTeamSize} äºº
- è·¨éƒ¨é–€å”ä½œç‡: ${(patterns.collaborationPattern.crossDepartmentRate * 100).toFixed(0)}%

è«‹ç”Ÿæˆä¸€æ®µ 2-3 å¥çš„å°ˆæ¥­æè¿°,èªªæ˜æ­¤æ¨¡æ¿é©ç”¨çš„å ´æ™¯å’Œç‰¹é»ã€‚
`;

    const response = await openai.chat.completions.create({
      model: 'gpt-4',
      messages: [
        {
          role: 'user',
          content: prompt,
        },
      ],
      temperature: 0.7,
      max_tokens: 200,
    });

    return response.choices[0].message.content!.trim();
  }
}
```

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### Docker éƒ¨ç½²

```dockerfile
# Dockerfile
FROM node:20-alpine AS builder

WORKDIR /app

# å®‰è£ä¾è³´
COPY package*.json ./
RUN npm ci

# è¤‡è£½åŸå§‹ç¢¼
COPY . .

# å»ºç½®
RUN npm run build

# ç”Ÿç”¢ç’°å¢ƒ
FROM node:20-alpine

WORKDIR /app

COPY --from=builder /app/dist ./dist
COPY --from=builder /app/node_modules ./node_modules
COPY --from=builder /app/package*.json ./

EXPOSE 3001

CMD ["node", "dist/server/index.js"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  postgres:
    image: postgres:14-alpine
    environment:
      POSTGRES_DB: task_management_ai
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: ${DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data

  app:
    build: .
    environment:
      DATABASE_URL: postgresql://postgres:${DB_PASSWORD}@postgres:5432/task_management_ai
      REDIS_URL: redis://redis:6379
      OPENAI_API_KEY: ${OPENAI_API_KEY}
      NODE_ENV: production
    ports:
      - "3001:3001"
    depends_on:
      - postgres
      - redis

volumes:
  postgres_data:
  redis_data:
```

### ç’°å¢ƒè®Šæ•¸

```bash
# .env.production
# è³‡æ–™åº«
DATABASE_URL=postgresql://user:password@localhost:5432/task_management_ai
REDIS_URL=redis://localhost:6379

# OpenAI
OPENAI_API_KEY=sk-...

# JWT
JWT_SECRET=your-secret-key

# S3 / MinIO
S3_ENDPOINT=https://s3.amazonaws.com
S3_BUCKET=task-management-files
S3_ACCESS_KEY=...
S3_SECRET_KEY=...

# éƒµä»¶
SENDGRID_API_KEY=...
EMAIL_FROM=noreply@yourdomain.com

# Slack
SLACK_WEBHOOK_URL=...

# æ‡‰ç”¨ç¨‹å¼
NODE_ENV=production
PORT=3001
FRONTEND_URL=https://yourdomain.com
```

---

## ğŸ“Š ç›£æ§èˆ‡ç¶­é‹

### æ•ˆèƒ½ç›£æ§

```typescript
// server/middleware/monitoring.ts
import { performance } from 'perf_hooks';

export function performanceMonitoring(req, res, next) {
  const start = performance.now();
  
  res.on('finish', () => {
    const duration = performance.now() - start;
    
    // è¨˜éŒ„æ…¢è«‹æ±‚
    if (duration > 1000) {
      console.warn(`Slow request: ${req.method} ${req.path} - ${duration.toFixed(2)}ms`);
    }
    
    // ç™¼é€åˆ°ç›£æ§ç³»çµ±
    metrics.recordHttpRequest({
      method: req.method,
      path: req.path,
      status: res.statusCode,
      duration,
    });
  });
  
  next();
}
```

### éŒ¯èª¤è¿½è¹¤

```typescript
// server/middleware/errorHandler.ts
export function errorHandler(err, req, res, next) {
  console.error('Error:', err);
  
  // ç™¼é€åˆ°éŒ¯èª¤è¿½è¹¤æœå‹™ (ä¾‹å¦‚ Sentry)
  if (process.env.SENTRY_DSN) {
    Sentry.captureException(err);
  }
  
  res.status(err.status || 500).json({
    error: {
      message: err.message,
      ...(process.env.NODE_ENV === 'development' && { stack: err.stack }),
    },
  });
}
```

---

## âœ… å¯¦ä½œæª¢æŸ¥æ¸…å–®

### éšæ®µ 1: åŸºç¤å»ºè¨­
- [ ] å»ºç«‹ PostgreSQL è³‡æ–™åº«
- [ ] åŸ·è¡Œè³‡æ–™åº«é·ç§»è…³æœ¬
- [ ] è¨­å®š Redis
- [ ] å»ºç«‹åŸºç¤ API æ¶æ§‹
- [ ] å¯¦ä½œä½¿ç”¨è€…èªè­‰

### éšæ®µ 2: æ ¸å¿ƒåŠŸèƒ½
- [ ] å¯¦ä½œä»»å‹™ CRUD API
- [ ] å¯¦ä½œäº‹ä»¶è¨˜éŒ„ç³»çµ±
- [ ] å¯¦ä½œå•é¡Œå›å ±åŠŸèƒ½
- [ ] æ•´åˆå‰ç«¯ä»»å‹™ç®¡ç†ä»‹é¢

### éšæ®µ 3: AI æ•´åˆ
- [ ] æ•´åˆ OpenAI API
- [ ] å¯¦ä½œä»»å‹™åˆ†æåŠŸèƒ½
- [ ] å¯¦ä½œå•é¡Œé æ¸¬åŠŸèƒ½
- [ ] å»ºç«‹ AI å­¸ç¿’è¨˜éŒ„

### éšæ®µ 4: æ¨¡æ¿ç³»çµ±
- [ ] å¯¦ä½œæ¨¡æ¿ CRUD
- [ ] å¯¦ä½œæ¨¡æ¿ç”Ÿæˆæ¼”ç®—æ³•
- [ ] å¯¦ä½œæ¨¡æ¿æ¨è–¦ç³»çµ±
- [ ] å»ºç«‹æ¨¡æ¿ä½¿ç”¨è¿½è¹¤

### éšæ®µ 5: æŒçºŒå„ªåŒ–
- [ ] å¯¦ä½œè‡ªå‹•å„ªåŒ–æ©Ÿåˆ¶
- [ ] å»ºç«‹ç›£æ§å„€è¡¨æ¿
- [ ] å¯¦ä½œ A/B æ¸¬è©¦
- [ ] å®Œå–„æ–‡ä»¶èˆ‡æ¸¬è©¦

---

**ç¸½çµ**: æœ¬å¯¦ä½œæŒ‡å—æä¾›å®Œæ•´çš„æŠ€è¡“ç´°ç¯€,å¾è³‡æ–™åº«è¨­è¨ˆåˆ° API å¯¦ä½œã€å‰ç«¯æ•´åˆåˆ° AI æœå‹™,æ¶µè“‹æ‰€æœ‰é—œéµç’°ç¯€ã€‚æŒ‰ç…§æ­¤æŒ‡å—å¾ªåºæ¼¸é€²,å³å¯å»ºç«‹ä¸€å€‹åŠŸèƒ½å®Œæ•´ã€å¯æ“´å±•çš„ AI å­¸ç¿’å‹ä»»å‹™ç®¡ç†ç³»çµ±ã€‚
